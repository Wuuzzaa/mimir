<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Yield Calculator</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function calculateYield() {
            $.ajax({
                url: '/calc_yield',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    init_option_premium: $('#init_option_premium').val(),
                    max_loss_via_stoploss: $('#max_loss_via_stoploss').val(),
                    delta_short_option: $('#delta_short_option').val(),
                    bpr: $('#bpr').val(),
                    profit: $('#profit').val(),
                    days_trade_open: $('#days_trade_open').val(),
                    dte: $('#dte').val(),
                    fees: $('#fees').val()
                }),
                success: function(response) {
                    $('#annualized_yield_now').text(response.annualized_yield_now + '%');
                    $('#annualized_yield_expiration').text(response.annualized_yield_expiration + '%');
                }
            });
        }

        $(document).ready(function() {
            $('input').on('input', calculateYield);
            calculateYield(); // Initial calculation with default values
        });
    </script>
</head>
<body>
    <h1>Yield Calculator</h1>
    <form>
        <label for="init_option_premium">Initial Option Premium:</label>
        <input type="number" id="init_option_premium" name="init_option_premium" required min="0" value="80"><br>

        <label for="max_loss_via_stoploss">Max Loss via Stoploss:</label>
        <input type="number" id="max_loss_via_stoploss" name="max_loss_via_stoploss" required min="0" value="160"><br>

        <label for="delta_short_option">Delta Short Option:</label>
        <input type="number" id="delta_short_option" name="delta_short_option" required min="0" value="0.2"><br>

        <label for="bpr">Buying Power Reduction (BPR):</label>
        <input type="number" id="bpr" name="bpr" required min="0" value="420"><br>

        <label for="profit">Profit:</label>
        <input type="number" id="profit" name="profit"  required min="0" value="35"><br>

        <label for="days_trade_open">Days Trade Open:</label>
        <input type="number" id="days_trade_open" name="days_trade_open" required min="0" value="15"><br>

        <label for="dte">Days to Expiration (DTE):</label>
        <input type="number" id="dte" name="dte" required min="0" value="40"><br>

        <label for="fees">Total fees position opening :</label>
        <input type="number" id="fees" name="fees" required min="0" value="7"><br>
    </form>
    <h2>Results</h2>
    <p>Annualized Yield Now: <span id="annualized_yield_now">0%</span></p>
    <p>Annualized Yield at Expiration: <span id="annualized_yield_expiration">0%</span></p>
</body>
</html>
